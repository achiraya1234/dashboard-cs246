import streamlit as st
import pandas as pd
import altair as alt

st.set_page_config(
    page_title="Dashboard",
    page_icon="ЁЯПВ",
    layout="wide",
    initial_sidebar_state="expanded")

alt.themes.enable("dark")

df = pd.read_csv('https://raw.githubusercontent.com/achiraya1234/dashboard-cs246/main/finalproject%20-%20Form%20Responses%201.csv')

df = df.rename(columns={'1. р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 1': 'р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 1',
                        '2. р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 2': 'р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 2',
                        '3. р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 3': 'р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 3'})

a1 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 1'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕Бр╕▓р╕гр╣Ар╕Фр╕┤р╕Щр╕Чр╕▓р╕Зр╣Бр╕ер╕░р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в']
b1 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 1'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓']
c1 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 1'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕кр╕╕р╕Вр╕ар╕▓р╕Ю']
d1 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 1'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕кр╕┤р╣Ир╕Зр╣Бр╕зр╕Фр╕ер╣Йр╕нр╕б']

a2 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 2'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕Бр╕▓р╕гр╣Ар╕Фр╕┤р╕Щр╕Чр╕▓р╕Зр╣Бр╕ер╕░р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в']
b2 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 2'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓']
c2 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 2'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕кр╕╕р╕Вр╕ар╕▓р╕Ю']
d2 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 2'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕кр╕┤р╣Ир╕Зр╣Бр╕зр╕Фр╕ер╣Йр╕нр╕б']

a3 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 3'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕Бр╕▓р╕гр╣Ар╕Фр╕┤р╕Щр╕Чр╕▓р╕Зр╣Бр╕ер╕░р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в']
b3 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 3'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓']
c3 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 3'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕кр╕╕р╕Вр╕ар╕▓р╕Ю']
d3 = df['р╕кр╕зр╕▒р╕кр╕Фр╕┤р╕Бр╕▓р╕гр╣Бр╕ер╕░р╕кр╕┤р╣Ир╕Зр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Нр╕нр╕▒р╕Щр╕Фр╕▒р╕Ъ 3'].value_counts()['р╕Фр╣Йр╕▓р╕Щр╕кр╕┤р╣Ир╕Зр╣Бр╕зр╕Фр╕ер╣Йр╕нр╕б']

######################################
# р╕кр╕гр╣Йр╕▓р╕З DataFrame
data = {
    'Categories': ['р╕Бр╕▓р╕гр╣Ар╕Фр╕┤р╕Щр╕Чр╕▓р╕Зр╣Бр╕ер╕░р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в', 'р╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓', 'р╕кр╕╕р╕Вр╕ар╕▓р╕Ю', 'р╕кр╕┤р╣Ир╕Зр╣Бр╕зр╕Фр╕ер╣Йр╕нр╕б'],
    'Rank 1': [a1, b1, c1, d1],
    'Rank 2': [a2, b2, c2, d2],
    'Rank 3': [a3, b3, c3, d3]
}
df30 = pd.DataFrame(data)

# р╕кр╕гр╣Йр╕▓р╕З Heatmap р╕Фр╣Йр╕зр╕в Altair
heatmap = alt.Chart(df30).mark_rect().encode(
    x=alt.X('Categories:N', title='Categories'),
    y=alt.Y('Rank:N', title='Rank'),
    color=alt.Color('value:Q', title='Value')
).transform_fold(
    fold=['Rank 1', 'Rank 2', 'Rank 3'],
    as_=['Rank', 'value']
).properties(
    title='Heatmap of Categories by Rank'
).facet(
    column='Rank:N',
    title=None
)

# р╣Бр╕кр╕Фр╕З Heatmap р╣Гр╕Щ Streamlit
st.altair_chart(heatmap)
